window.noscroll=function(a){a.preventDefault()};(function(c,b,a){c(a).on("focus","input, textarea",function(d){a.addEventListener("scroll",b.noscroll,false)}).on("blur","input, textarea",function(){a.removeEventListener("scroll",b.noscroll,false)})})(jQuery,window,document);(function(d){var a=d.localStorage;var e=d.globalConfig;var c=e.locStoKey||"storage";var b=a.getItem(c);if(!!b){return d.currLocStorage=JSON.parse(b)}$.sendAjax({type:"GET",url:e.urlPrefix+"/crm/get_storage",dataType:"json",async:false,processData:true,xhrFields:{withCredentials:true},success:function(f,h,g){if(f&&f["storage"]){a.setItem(c,JSON.stringify(f["storage"]||""));d.currLocStorage=f["storage"]}},error:function(f,h,g){}})})(window);(function(c,b,a,d){c.event.special.mtouchstart={setup:function(){var e=this;c.event.add(e,"touchstart",function(g){var f=g.originalEvent.touches[0];c.event.trigger("mtouchstart",{"pagex":f.pageX,"pagey":f.pageY},e)})}},c.event.special.mtouchmove={setup:function(){var e=this;c.event.add(e,"touchmove",function(g){var f=g.originalEvent.touches[0];c.event.trigger("mtouchmove",{"pagex":f.pageX,"pagey":f.pageY},e)})}},c.event.special.mtouchend={setup:function(){var e=this;c.event.add(e,"touchend",function(f){var g=f.originalEvent.touches[0];c.event.trigger("mtouchend",null,e)})}},c.event.special.fastclick={setup:function(){var e=this;c.event.add(e,"touchstart",function(f){e.move=0});c.event.add(e,"touchmove",function(f){e.move=1});c.event.add(e,"touchend",function(f){if(e.move==0){c.event.trigger("fastclick",null,e)}})}},c.event.special.swipeleft={setup:function(){var e=this;c.event.add(e,"touchstart",function(f){e.spagex=f.originalEvent.touches[0].pageX});c.event.add(e,"touchend",function(f){if(f.originalEvent.changedTouches[0].pageX-e.spagex<-50){c.event.trigger("swipeleft",null,e)}})}},c.event.special.swiperight={setup:function(){var e=this;c.event.add(e,"touchstart",function(f){e.spagex=f.originalEvent.touches[0].pageX});c.event.add(e,"touchend",function(f){if(f.originalEvent.changedTouches[0].pageX-e.spagex>50){c.event.trigger("swiperight",null,e)}})}},c.event.special.swipeup={setup:function(){var e=this;c.event.add(e,"touchstart",function(f){e.spagey=f.originalEvent.touches[0].pageY});c.event.add(e,"touchend",function(f){if(f.originalEvent.changedTouches[0].pageY<(e.spagey-50)){c.event.trigger("swipeup",null,e)}})}},c.event.special.swipedown={setup:function(){var e=this;c.event.add(e,"touchstart",function(f){e.spagey=f.originalEvent.touches[0].pageY});c.event.add(e,"touchend",function(f){if(f.originalEvent.changedTouches[0].pageY>(e.spagey+50)){c.event.trigger("swipedown",null,e)}})}}})(jQuery,window,document);(function(c,b,a,d){c.fn.extend({swipedel:function(e){function f(g){this.triggerPoint=e||60;this.sp=0;this.ep=0;this.elems=g;this.timer=null;this.init()}f.prototype={constructor:f,init:function(){this.elems.on("touchstart",this.start.bind(this)).on("touchend",this.end.bind(this)).on("touchmove",this.move.bind(this));this.elems.find(".delete").on("touchstart",function(g){return false})},start:function(g){this.sp=0;this.ep=0;a.body.addEventListener("touchmove",noscroll,false);this.sp=g.originalEvent.changedTouches[0].pageX},move:function(g){clearTimeout(this.timer);this.timer=setTimeout(function(){this.mp=g.originalEvent.changedTouches[0].pageX}.bind(this),10)},end:function(g){var h=c(g.currentTarget).find(".box"),i="";if(h.hasClass("fa")){h.click();return false}this.ep=g.originalEvent.changedTouches[0].pageX;if((this.sp-this.ep)>=this.triggerPoint){this.reset();i="-webkit-transform:translate3d(-"+this.triggerPoint+"px,0,0);transform:translate3d(-"+this.triggerPoint+"px,0,0)"}if((this.ep-this.sp)>=this.triggerPoint){i="-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)"}h.attr("style",i);a.body.removeEventListener("touchmove",noscroll,false)},reset:function(){this.elems.find(".box").each(function(g,h){c(h).attr("style","-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)")})}};new f(this)},lazyload:function(e){var g=this;var f=null;c(b).scroll(function(){clearTimeout(f);f=setTimeout(function(){var i=g.find("img[data-lazy-src]");var h=b.innerHeight;i.each(function(j,k){k=c(k);var m=k.offset().top;var l=c(b).scrollTop();if((m-l)<(h+50)){k.attr("src",k.attr("data-lazy-src"));k.removeAttr("data-lazy-src")}})},10)});c(b).trigger("scroll")}});c.extend({gentoolbar:function(e){function f(g){this.mainTemp=g.mainToolBarTemp||"";if(!this.mainTemp){return false}this.localTemp=g.localToolBarTemp||"";this.bodyElem=g.bodyElem||c("body");this.listWidth=g.listWidth||170;this.pageId=g.pageId||"";this.mainTemp=this.mainTemp.replace("{{localtemp}}",(g.localToolBarTemp||""));this.mainElem=c(this.mainTemp);this.menuListPanel=this.mainElem.find("#J_menuListPanel");this.menubox=this.mainElem.find("#J_menubox");this.sy=0;this.ey=0;this.init()}f.prototype={constructor:f,init:function(){this.initActive();this.bindEvent();return this.mainElem.appendTo(this.bodyElem)},setBtnItem:function(h){var g=this.mainElem.find("#J_btnlist a");
    g.hide().filter("[data-showkey="+h+"]").show()},initActive:function(){this.mainElem.find("a[data-pageid="+this.pageId+"]").addClass("active")},bindEvent:function(){var g=null;this.mainElem.on("click","#J_goBack",this._goBack.bind(this));this.mainElem.on("click","#J_showMenuList",this._showMenuList.bind(this));this.mainElem.on("click","#J_mask",this._hideMenuList.bind(this));this.mainElem.on("click","#J_btnlist a",this._toggleBtnState.bind(this));this.menubox.on("mtouchstart",function(h,i){this.sy=i.pagey}.bind(this));this.menubox.on("mtouchmove",function(h,i){clearTimeout(g);g=setTimeout(function(){this.ey=i.pagey;this.menubox.scrollTop(this.sy-this.ey)}.bind(this),100)}.bind(this))},genGloTemp:function(){return this.mainTemp.replace("{{localtemp}}",this.localTemp)},_goBack:function(){b.history.go(-1)},_showMenuList:function(){this.bodyElem.css({"overflow":"hidden"});a.addEventListener("touchmove",function(g){g.preventDefault()},false);this.menuListPanel.show().find("#J_list").animate({"right":"0px"})},_hideMenuList:function(){this.menuListPanel.find("#J_list").animate({"right":"-"+this.listWidth+"px"},"fast","linear",function(){this.bodyElem.css({"overflow":"auto"});a.removeEventListener("touchmove",function(g){g.preventDefault()},false);this.menuListPanel.hide()}.bind(this))},_toggleBtnState:function(h){var i=c(h.target);var g=i.siblings();if(g.length){i.addClass("active").siblings().removeClass("active")}}};return new f(e)},confirm:function(g){var i=g.msg;var j=g.callback;var f=g.suretext?g.suretext:"确定";var h='<div class="extendpop ptf hp100 wp100 z10"><div class="popbox pta ovh bdr3 bgcfff"><p class="text alic fs16 c66 lh20">'+i+'</p><p class="btn confirm"><a href="javascript:;" data-do="no" class="alic dsb wp50 dsb fl fs16 c66">取消</a><a class="alic dsb wp50 dsb fl fs16 c66 cf" href="javascript:;" data-do="yes">'+f+"</a></p></div></div>";var e=c("body").append(h).find(".extendpop");c('.extendpop a[data-do="no"]').click(function(){e.remove();j(0)});c('.extendpop a[data-do="yes"]').click(function(){e.remove();j(1)})},alert:function(f){var h=f.msg;var g='<div class="extendpop ptf hp100 wp100 z10"><div class="popbox pta ovh bdr3 bgcfff"><p class="text alic fs16 c66 lh20">'+h+'</p><p class="btn alert"><a class="alic dsb dsb fl fs16 c66" href="javascript:;" data-do="yes">确定</a></p></div></div>';var e=c("body").append(g).find(".extendpop");c('.extendpop a[data-do="yes"]').click(function(){e.remove();if(f.callback){f.callback()}})},tipshow:function(f){var j=f.msg;var g=f.type?f.type:"info";var h=f.ico?f.ico:"info-circle";var i='<div class="tippop ptf z10 fs12 wp100 alic"><div class="dsilb fs12 text '+g+'"><i class="fa fa-'+h+'"></i>'+j+"</div></div>";var e=c("body").append(i).find(".tippop");setTimeout(function(){e.animate({"opacity":0},600,function(){e.remove();if(f.callback){f.callback()}})},1500)},tipshowopen:function(e){var i=e.msg;var f=e.type?e.type:"info";var g=e.ico?e.ico:"info-circle";var h='<div class="tippop ptf z10 fs12 wp100 alic"><div class="dsilb fs12 text '+f+'"><i class="fa fa-'+g+'"></i>'+i+"</div></div>";c("body").append(h)},tipshowup:function(f){var i=f.msg;var g=f.type?f.type:"info";var h=f.ico?f.ico:"info-circle";var e=c(".tippop");e.find(".text").html('<i class="fa fa-'+h+'"></i>'+i)},tipshowclose:function(f){var i=f.msg;var g=f.type?f.type:"info";var h=f.ico?f.ico:"info-circle";var e=c(".tippop");e.find(".text").attr("class","text "+g);e.find(".i").attr("class","fa fa-"+g);e.find(".text").html('<i class="fa fa-'+h+'"></i>'+i);setTimeout(function(){e.animate({"opacity":0},600,function(){e.remove();if(f.callback){f.callback()}})},1200)},tiplist:function(m){c(".tiplistfixed").length<=0?c("body").append('<div class="tiplistfixed"></div>'):"";var f=c(".tiplistfixed");var h=c(".tiplistfixed").children().length+1;var e=m.msg;var j=m.type?m.type:"info";var g=m.ico?m.ico:"info-circle";var l=m.close?'<i class="fa fa-times close"></i>':"";var i='<div class="item item'+h+'"><div class="text '+j+'"><i class="fa fa-'+g+'"></i>'+e+"</div>"+l+"</div>";var k=f.append(i).find(".item"+h);if(m.close){k.find(".close").click(function(){k.remove();if(m.callback){m.callback()}if(f.children().length==0){f.remove()}})}else{setTimeout(function(){k.slideUp(600,function(){k.remove();if(m.callback){m.callback()}if(f.children().length==0){f.remove()}})},3000)}},starting:function(e){var f=e;c(".html").append('<div class="starting ptf z10 hp100 wp100 "><p class="pta wp100 lh26 alic cff"><img src="http://7xix4h.com1.z0.glb.clouddn.com/images/loading.gif" height="16">'+f+"</p></div>")},endingtext:function(e){c(".starting p").html(e);setTimeout(function(){c(".starting").remove()},1000)},ending:function(e){c(".starting").remove()},emptystart:function(){c(".html").html('<img src="http://7xix4h.com1.z0.glb.clouddn.com/images/loading.gif" height="16" class="emptystartimg">')},endempty:function(){c(".emptystartimg").remove()},bodyempty:function(e){var f='<img class="ptf lp50 tp50" style="width:100px; margin:-37px 0 0 -50px; z-index:1;" src="http://7xix4h.com1.z0.glb.clouddn.com/images/empty.png">';
    if(e){return e.html(f)}c("body").append(f)},getRequest:function(){var h=b.location.search,g={},k="",f=[];if(h.indexOf("?")!=-1){k=h.substr(1);strs=k.split("&");for(var j=0,e=strs.length;j<e;j++){f=strs[j].split("=");g[f[0]]=decodeURIComponent((f.length>=2)?f[1]:"")}}return g},isAnd:function(){var e=b.navigator.userAgent;if(e.indexOf("Android")>-1||e.indexOf("Linux")>-1){return 1}else{return 0}},cookie:function(e,h,g){var i=a;var f={get:function(k){var n=encodeURIComponent(k)+"=",j=i.cookie.indexOf(n),m=null;if(j>-1){var l=i.cookie.indexOf(";",j);if(l==-1){l=i.cookie.length}m=decodeURIComponent(i.cookie.substring(j+n.length,l))}return m},set:function(k,n,j,p,m,o){var l=encodeURIComponent(k)+"="+encodeURIComponent(n);if(j instanceof Date){l+="; expires="+j.toGMTString()}if(p){l+="; path="+p}if(m){l+="; domain="+m}if(o){l+="; secure"}i.cookie=l;return true},unset:function(j,m,k,l){this.set(j,"",new Date(0),m,k,l);return true}};if(h===d){return f.get(e)}if(h===""){return f.unset(e,h,(g&&g.path||null),(g&&g.domain||null),(g&&g.secure||null))}return f.set(e,h,(g&&g.expires||null),(g&&g.path||null),(g&&g.domain||null),(g&&g.secure||null))},removeCookie:function(f,e){if(!f){return false}return c.cookie(f,"",e)},formatDay:function(e){return(parseInt(e,10)>=10)?e:"0"+(parseInt(e,10))},formatDate:function(h,g){if(!h||!g){return""}var f="";if(/^\d+$/.test(h)){f=new Date(+(h))}else{f=new Date(h.replace(/-/g,"/"))}var i={"M+":f.getMonth()+1,"d+":f.getDate(),"h+":f.getHours(),"m+":f.getMinutes(),"s+":f.getSeconds(),"q+":Math.floor((f.getMonth()+3)/3),"S":f.getMilliseconds()};if(/(y+)/.test(g)){g=g.replace(RegExp.$1,(f.getFullYear()+"").substr(4-RegExp.$1.length))}for(var e in i){if(new RegExp("("+e+")").test(g)){g=g.replace(RegExp.$1,RegExp.$1.length==1?i[e]:("00"+i[e]).substr((""+i[e]).length))}}return g},getPhoneById:function(g,f){f=f||b.currLocStorage||JSON.parse(b.localStorage(b.globalConfig.locStoKey));if(!f||!g){return""}if(f[g]){if(f[g]["contact_info"]){return f[g]["contact_info"]["mobi"]||""}}return""},getNameById:function(g,f){f=f||b.currLocStorage||JSON.parse(b.localStorage(b.globalConfig.locStoKey));if(!f||!g){return""}if(f[g]){if(f[g]["name"]){return f[g]["name"]||""}}return""},getChildNameByParentId:function(g,f){f=f||b.currLocStorage||JSON.parse(b.localStorage(b.globalConfig.locStoKey));if(!f||!g){return""}if(f[g]&&f[g]["child"]){return f[g]["child"]["name"]||""}return""},getChildIdsByClassId:function(g,f){f=f||b.currLocStorage||JSON.parse(b.localStorage(b.globalConfig.locStoKey));if(!f||!g){return[]}if(f[g]){if(f[g]["child_ids"]){return f[g]["child_ids"]||[]}}return[]},getTeacherIdsByClassId:function(g,f){f=f||b.currLocStorage||JSON.parse(b.localStorage(b.globalConfig.locStoKey));if(!f||!g){return""}if(f[g]){if(f[g]["teacher_ids"]){return f[g]["teacher_ids"]||[]}}return""},getRelationByParentId:function(h,f){f=f||b.currLocStorage||JSON.parse(b.localStorage(b.globalConfig.locStoKey));if(!f||!h){return""}if(f[h]){var g=f[h]["relation"]>-1?f[h]["relation"]:0;if(g===0){return"妈妈"}if(g===1){return"爸爸"}if(g===2){return"爷爷"}if(g===3){return"奶奶"}if(g===4){return"叔叔"}if(g===5){return"阿姨"}if(g===6){return"其他"}}return""},getChildInfoByParentId:function(g,f){f=f||b.currLocStorage||JSON.parse(b.localStorage(b.globalConfig.locStoKey));if(!f||!g){return""}if(f[g]&&f[g]["child"]){if(f[g]["child"]["_id"]||f[g]["child"]["name"]){return f[g]["child"]}}return""},getChildIdByParentId:function(g,f){f=f||b.currLocStorage||JSON.parse(b.localStorage(b.globalConfig.locStoKey));if(!f||!g){return""}if(f[g]&&f[g]["child"]){return f[g]["child"]["_id"]||""}return""},getParentIdsByChildId:function(g,f){f=f||b.currLocStorage||JSON.parse(b.localStorage(b.globalConfig.locStoKey));if(!f||!g){return[]}if(f[g]&&f[g]["parent_ids"]){return f[g]["parent_ids"]||[]}return[]},getInfoById:function(f,g){if(!f||!g){return{}}if(f[g]){return f[g]}return{}},getCurrUserId:function(f){f=f||b.currLocStorage||JSON.parse(b.localStorage(b.globalConfig.locStoKey));if(f&&f["curr"]&&f["curr"]["_id"]){return f["curr"]["_id"]}return""},getCurrClassId:function(f){f=f||b.currLocStorage||JSON.parse(b.localStorage(b.globalConfig.locStoKey));if(f&&f["curr"]&&f["curr"]["class_id"]){return f["curr"]["class_id"]}return""},getCurrKgId:function(f){f=f||b.currLocStorage||JSON.parse(b.localStorage(b.globalConfig.locStoKey));if(f&&f["curr"]&&f["curr"]["kg_id"]){return f["curr"]["kg_id"]}return""},getCurrRelation:function(f){f=f||b.currLocStorage||JSON.parse(b.localStorage(b.globalConfig.locStoKey));if(f&&f["curr"]&&(f["curr"]["relation"]!==null)){return f["curr"]["relation"]}return null}})})(jQuery,window,document);var PhotoSwipt=(function(c,b,a,d){function e(f){var j=this;var h=c(f.element);this.ele=h;this.box=h.find(".list");this.len=h.find(".ls").length;this.botline=h.find(".botdo");this.closeimg=h.find(".closeimg");this.winw=c(b).width();this.winh=c(b).height();this.eq=0;this.pagex=0;var g=0;var i=0;this.key=0;this.stylestr="width:"+this.len*this.winw+"px;-webkit-transition: -webkit-transform 0.4s;transition:transform 0.4s;-webkit-transform:-webkit-translate3d("+this.eq*this.winw+"px,0,0);transform:translate3d("+this.eq*this.winw+"px,0,0)";
    this.box.attr("style",this.stylestr);h.on("click","img",function(){if(!j.isMe){return false}j.botline.slideToggle()}).on("click",".collect",function(){f.colCallBack.call(f.scope,j.key);return false}).on("click",".delete",function(){f.delCallBack.call(f.scope,j.key);return false});this.closeimg.click(function(){h.animate({"left":j.winw},400);a.removeEventListener("touchmove",noscroll,false)});h.on("mtouchstart",function(k,l){g=l.pagex}).on("mtouchend",function(){if(i<50&&i>-50&&i!=0){j.box.attr("style","width:"+j.len*j.winw+"px;-webkit-transition: -webkit-transform 0.4s;transition:transform 0.4s;-webkit-transform:translate3d("+(j.eq*j.winw)+"px,0,0);transform:translate3d("+(j.eq*j.winw)+"px,0,0)")}}).on("mtouchmove",function(l,m){var k=m.pagex-g;i=k;var n="width:"+j.len*j.winw+"px;"+"-webkit-transition-timing-function: cubic-bezier(0.42,0,0.58,1); "+"transition-timing-function: cubic-bezier(0.42,0,0.58,1); "+"-webkit-transition-duration: 0ms; "+"transition-duration: 0ms; "+"-webkit-transform: translate("+(j.eq*j.winw+k)+"px, 0px);"+"transform: translate("+(j.eq*j.winw+k)+"px, 0px);";j.box.attr("style",n);return}).on("swipeleft",function(k){if(j.eq+j.len>=2){j.eq--}j.showcenter(j.imgs.eq(-j.eq),j.winw,j.winh);j.key=j.imgs.eq(-j.eq).data("key");j.box.attr("style","width:"+j.len*j.winw+"px;"+"-webkit-transition-timing-function: cubic-bezier(0.1, 0.57, 0.1, 1); "+"transition-timing-function: cubic-bezier(0.1, 0.57, 0.1, 1); "+"-webkit-transition: -webkit-transform 0.4s;"+"transition:transform 0.4s;"+"-webkit-transform:translate3d("+(j.eq*j.winw)+"px, 0px, 0px);"+"transform:translate3d("+(j.eq*j.winw)+"px, 0px, 0px)")}).on("swiperight",function(k){if(j.eq<0){j.eq++}j.showcenter(j.imgs.eq(-j.eq),j.winw,j.winh);j.key=j.imgs.eq(-j.eq).data("key");j.box.attr("style","width:"+j.len*j.winw+"px;"+"-webkit-transition-timing-function: cubic-bezier(0.1, 0.57, 0.1, 1); "+"transition-timing-function: cubic-bezier(0.1, 0.57, 0.1, 1); "+"-webkit-transition: -webkit-transform 0.4s;"+"transition:transform 0.4s;"+"-webkit-transform:translate3d("+(j.eq*j.winw)+"px, 0px, 0px);"+"transform:translate3d("+(j.eq*j.winw)+"px, 0px, 0px)")});return j}e.prototype={constructor:e,initialbox:function(){if(this.len===0){this.ele.animate({"left":this.winw},400);a.removeEventListener("touchmove",noscroll,false);return false}if(this.len+this.eq){this.stylestr="width:"+this.len*this.winw+"px;"+"left:"+(this.eq*this.winw)+"px"}else{this.stylestr="width:"+this.len*this.winw+"px;"+"left:"+((this.eq+1)*this.winw)+"px"}this.box.attr("style",this.stylestr);this.imgs=this.ele.find(".list img");this.showcenter(this.imgs.eq(-this.eq),this.winw,this.winh);this.key=this.imgs.eq(-this.eq).data("key");this.botline.slideDown();if(!(this.len+this.eq)){this.eq++}a.addEventListener("touchmove",noscroll,false);this.ele.animate({"left":0})},showcenter:function(i,f,k){var j=k/f;if(i.data("src")!="no"){var g=new Image;var l=i.data("src");g.src=l;g.onload=function(){var h=this.width;var n=this.height;var m=n/h;if(m>=j&&n>=k){i.attr({"src":l,"style":"height:"+k+"px;"+"display:none;"});i.data("src","no");i.fadeIn()}else{if(m<j&&h>f){i.attr({"src":l,"style":"width:"+f+"px;"+"margin-top:"+((k-n*f/h)/2)+"px;"+"display:none;"});i.data("src","no");i.fadeIn()}else{i.attr({"src":l,"style":"margin-top:"+Math.ceil((k-n)/2)+"px;width:"+h+"px;display:none;"});i.data("src","no");i.fadeIn()}}}}}};return e})(jQuery,window,document);